# Refreshing tokens for more secure authentications and workflow

### Access tokens are intentionally given a short lifespan (usually minutes or hours) to minimize the damage if they're stolen. If an attacker gets an access token, they can only use it until it expires.

### Rather than making users log in again when their access token expires, we use refresh tokens which have longer lifespan, and only these tokens can be used to generate new Access tokens or refresh tokens as these tokens firstly have a token_secret embeded in its secret so that while decoding it we get the token which is actually generated by our server, secondly these tokens are saved with user's information in db, so before generating, both will be matched and then only new token generation and further work happens.


1. Get refresh token either from cookie storage or body, if token is not obtained throw an error.
2. Decode the token meaning check the token where it's refresh_token_secret matches, if yes then we can get the user based on this refresh token.
3. If refresh token is correct, as it is also saved in every user's info (DB), we can get details of user.
4. If user not present or both refresh tokens do not match, then just throw errors preventing use of stolen or reused refresh tokens.
5. If tokens match, generate new tokens and send it as a response.
